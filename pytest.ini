[tool:pytest]
minversion = 6.0
addopts = -ra -q --strict-markers --strict-config --tb=short
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
timeout = 300
markers =
    # Test Types
    unit: marks tests as unit tests
    integration: marks tests as integration tests
    e2e: marks tests as end-to-end tests
    performance: marks tests as performance tests
    security: marks tests as security tests
    
    # ADHD-Specific Test Categories
    adhd: marks tests as ADHD-specific functionality tests
    adhd_critical: marks tests critical for ADHD user success
    adhd_scenarios: marks tests for realistic ADHD user scenarios
    executive_function: marks tests for executive function support
    hyperfocus: marks tests for hyperfocus management
    overwhelm: marks tests for overwhelm detection and intervention
    
    # Safety and Crisis Tests (Life-Critical)
    life_critical: marks tests that are life-critical for user safety
    crisis: marks tests for crisis support features (life-critical)
    crisis_detection: marks tests for crisis pattern detection
    safety_response: marks tests for safety response validation
    emergency_access: marks tests for emergency access bypass
    circuit_breaker: marks tests for psychological circuit breaker
    
    # System Components
    auth: marks tests that require authentication
    cognitive_loop: marks tests for cognitive loop processing
    llm: marks tests that require LLM
    database: marks tests that require database
    redis: marks tests that require Redis
    
    # Performance and Load
    adhd_performance: marks tests for ADHD-specific performance requirements
    response_time: marks tests for response time requirements
    load_testing: marks tests for system load and concurrency
    memory_usage: marks tests for memory usage optimization
    
    # Security
    auth_security: marks tests for authentication security
    rate_limiting: marks tests for rate limiting and abuse prevention
    attack_vectors: marks tests for common attack vectors
    
    # Accessibility and UX
    accessibility: marks tests for accessibility compliance
    wcag: marks tests for WCAG 2.1 AA compliance
    multi_disability: marks tests for multiple disability intersections
    ux: marks tests for ADHD-friendly user experience
    
    # Monitoring and Health
    health: marks tests for health monitoring
    metrics: marks tests for metrics collection
    alerts: marks tests for alerting system
    
    # Infrastructure
    lighthouse: marks tests using Lighthouse auditing
    slow: marks tests as slow (deselect with '-m "not slow"')

# Test execution configuration
filterwarnings =
    error
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore::RuntimeWarning
    ignore:.*aiosqlite.*:UserWarning

# Logging configuration
log_cli = true
log_cli_level = WARNING
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Async support
asyncio_mode = auto

# Coverage configuration
addopts = --cov=src --cov-report=term-missing --cov-report=html:htmlcov --cov-fail-under=85